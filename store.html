<!DOCTYPE HTML>
<html lang="en">

<head>
    <!--=============== basic  ===============-->
    <meta charset="UTF-8">
    <title>Store</title>
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="robots" content="index, follow" />
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <!--=============== css  ===============-->
    <link type="text/css" rel="stylesheet" href="css/reset.css">
    <link type="text/css" rel="stylesheet" href="css/plugins.css">
    <link type="text/css" rel="stylesheet" href="css/style.css">
    <link type="text/css" rel="stylesheet" href="css/style-dark.css">
    <!--=============== favicons ===============-->
    <link rel="shortcut icon" href="images/favicon.ico">
</head>

<body>
    <!--loader-->
    <div class="loader-wrap">
        <div class="spinner">
            <div class="double-bounce1"></div>
            <div class="double-bounce2"></div>
        </div>
    </div>
    <!--loader end-->
    <!-- main start  -->
    <div id="main">
        <!-- header start  -->
        <header class="main-header">        
            <a href="index.html" class="logo-holder"><img src="images/logo.png" alt=""></a>  
            <!-- logo end  -->		
            <!-- search -->				
            <div class="search-button"><i class="far fa-search"></i></div>
            <div class="search-input"><input name="se" id="se" type="text" class="search" placeholder="Search.." /></div>
            <!-- search end  -->
            <!-- mobile nav -->
            <div class="nav-button-wrap">
                <div class="nav-button"><span></span><span></span><span></span></div>
            </div>
            <!-- mobile nav end-->				
            <!--  navigation -->
            <div class="nav-holder main-menu">
                <nav>
                    <ul>
                        <li>
                            <a href="index.html">Home </a>
                        </li>
                        <li>
                            <a href="store.html">Store </a>
                        </li>
                        <li>
                            <a href="about.html">About</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>
        <!-- header end -->
        <!-- wrapper  -->
        <div id="wrapper">
            <!-- content -->
            <div class="content">
                <!--bottom-filter-wrap-->
                <div class="bottom-filter-wrap hor-filter-wrap">
                    <div class="scroll-down-wrap">
                        <div class="mousey">
                            <div class="scroller"></div>
                        </div>
                        <span>Scroll down to discover</span>
                    </div>
                    <div class="filter-title">Filters <i class="fal fa-long-arrow-right"></i></div>
                    <div class="gallery-filters" id="buttonContainer">
                        <a href="#" class="gallery-filter  gallery-filter-active" onclick="filterSelection('all')">All</a>
                        <a href="#" class="gallery-filter" onclick="filterSelection('shirts')">T-Shirts</a>
                        <a href="#" class="gallery-filter" onclick="filterSelection('outerwear')">Jackets && Hoodies</a>
                        <a href="#" class="gallery-filter" onclick="filterSelection('bottoms')">Bottoms</a>
                        <a href="#" class="gallery-filter" onclick="filterSelection('misc')">Misc</a>
                    </div>
                    <div class="count-folio round-counter">
                        <div id="num-album"></div>
                        <div id="all-album"></div>
                    </div>
                </div>
                <!--bottom-filter-wrap end-->
                <div class="ff_panel-conainer fl-wrap" id="counters">
                    <!-- portfolio start -->
                    <div class="gallery-items min-pad   four-column fl-wrap lightgallery">
                        <!-- gallery-item-->
                        <div id="items"></div>
                        <!-- gallery-item end-->
                    </div>
                    <!-- portfolio end -->
                </div>
            </div>
            <!--content end-->
            <!--share-wrapper-->
            <div class="share-wrapper">
                <div class="share-container fl-wrap  isShare"></div>
            </div>
            <!--share-wrapper end-->
        </div>
        <!-- wrapper end -->
    </div>
    <!-- Main end -->
    <!--=============== scripts  ===============-->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/plugins.js"></script>
    <script type="text/javascript" src="js/scripts.js"></script>
    <script src="js/mgGlitch.min.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/utils.js"></script>

    <!-- Dynamically Loading Items from the DB -->
    <script>

        var items = []
        var element = document.getElementById("items");
        $.ajax({
            url: "https://0isykk2a2g.execute-api.us-east-1.amazonaws.com/Prod/getitem",
            method: 'GET',
            success: function (json) {
                items = json;
                items.forEach(appendItemHTML);
                $('#all-album').html(items.length)
                $('#num-album').html(element.childElementCount)
                filterSelection("all")
            }
        });

        function appendItemHTML(item) {
            soldOutHTML = ''
            totalStock = 0;
            for(let i = 0; i < item["stock"].length; i++){
                let sizeObject = item["stock"][i]
                totalStock += Object.values(sizeObject)[0]
            }
            
            if (totalStock < 1){
                soldOutHTML = '<p style="color:red">SOLD OUT</p>';
            }

            $("#items").append(
                $.parseHTML(
                    '<div class="gallery-item ' + item.type + '">' +
                        '<div class="grid-item-holder hov_zoom">' +
                            '<img src="' + item.s3Image + '" alt="">' +
                            '<a href="images/folio/1.jpg" class="box-media-zoom popup-image"><i class="fal fa-search"></i></a>' +
                    '<div class="thumb-info">' +
                        '<h3><a href="singleItem.html?itemID='+ item.itemID + '">' + item.itemName + '</a></h3>' +
                        '<p>PRICE: ' + item.price + '</p>' + 
                        soldOutHTML +
                    '</div>' +
                '</div>' +
            '</div>'
            ));
        };
    </script>

    <!-- Filter Content -->
    <script>
        function filterSelection(c) {
            var x, i;
            x = document.getElementsByClassName("gallery-item");
            console.log(x)
            if (c == "all") c = "";
            // Add the "show" class (display:block) to the filtered elements, and remove the "show" class from the elements that are not selected
            countShownItems = 0
            for (i = 0; i < x.length; i++) {
                w3RemoveClass(x[i], "show");
                if (x[i].className.indexOf(c) > -1){ 
                    w3AddClass(x[i], "show");
                    countShownItems++;
                }
            }
            $('#num-album').html(countShownItems)
        }

        // Show filtered elements
        function w3AddClass(element, name) {
            var i, arr1, arr2;
            arr1 = element.className.split(" ");
            arr2 = name.split(" ");
            for (i = 0; i < arr2.length; i++) {
                if (arr1.indexOf(arr2[i]) == -1) {
                element.className += " " + arr2[i];
                }
            }
        }

        // Hide elements that are not selected
        function w3RemoveClass(element, name) {
            var i, arr1, arr2;
            arr1 = element.className.split(" ");
            arr2 = name.split(" ");
            for (i = 0; i < arr2.length; i++) {
                while (arr1.indexOf(arr2[i]) > -1) {
                arr1.splice(arr1.indexOf(arr2[i]), 1);
                }
            }
            element.className = arr1.join(" ");
        }

        // Add active class to the current control button (highlight it)
        var btnContainer = document.getElementById("buttonContainer");
        var btns = btnContainer.getElementsByClassName("gallery-filter");
        for (var i = 0; i < btns.length; i++) {
            btns[i].addEventListener("click", function() {
                var current = document.getElementsByClassName("gallery-filter-active");
                current[0].className = current[0].className.replace(" gallery-filter-active", "");
                this.className += " gallery-filter-active";
            });
        }
    
    </script>
</body>

</html>